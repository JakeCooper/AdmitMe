{"name":"smart-mixin","version":"1.2.1","description":"![travis](https://travis-ci.org/brigand/smart-mixin.svg)","main":"index.js","scripts":{"test":"mocha test/*"},"keywords":["class","es6","mixin","behavior"],"author":{"name":"Frankie Bagnardi","email":"f.bagnardi@gmail.com"},"license":"MIT","devDependencies":{"6to5ify":"^4.0.0","expect.js":"^0.3.1","mocha":"^2.1.0","sinon":"^1.12.2"},"readme":"![travis](https://travis-ci.org/brigand/smart-mixin.svg)\n\nMixins with smart merging strategies and errors over silent failure.\n\nInstall with one of:\n\n```sh\n# recommended\nnpm install --save smart-mixin\n\n# will expose window.smartMixin or the smartMixin AMD module\ncurl 'wzrd.in/standalone/smart-mixin@1' > vendor/smart-mixin.js \n```\n\nUsage:\n\n```js\nvar mixins = require('smart-mixin');\n\n// define a mixin behavior\nvar mixIntoGameObject = mixins({\n    // this can only be defined once, will throw otherwise\n    render: mixins.ONCE,\n\n    // can be defined in the source and mixins\n    // only the source return value will be returned\n    // the mixin function is called first (as in all of the following except REDUCE_LEFT)\n    onClick: mixins.MANY,\n\n    // like MANY but expects objects to be returned\n    // which will be merged with the other objects\n    // will throw when duplicate keys are found\n    getState: mixins.MANY_MERGED,\n\n    // like MANY_MERGED but also handles arrays, and non-function properties\n    // the behavior expressed in pseudo pattern matching syntax:\n    //  undefined, y:any => y\n    //  x:any, undefined => x\n    //  x:Array, y:Array => x.concat(y)\n    //  x:Object, y:Object => merge(x, y) // key conflicts cause error\n    //  _, _ => THROWS\n    getSomething: mixins.MANY_MERGED_LOOSE,\n\n    // this calls the next function with the return value of\n    // the previous\n    // if not present the default value is the identity function\n    // in REDUCE_LEFT this looks like mixinFn(sourceFn(...args));\n    // in REDUCE_RIGHT this looks like sourceFn(mixinFn(...args));\n    // of course the `this` value is still preserved\n    countChickens: mixins.REDUCE_LEFT,\n    countDucks: mixins.REDUCE_RIGHT,\n\n    \n\n    // define your own handler for it\n    // the two operands are the value of onKeyPress on each object\n    // these could be functions, undefined, or in strange cases something else\n    // don't forget to call them with `this` set correctly\n    // here we allow event.stopImmediatePropagation() to prevent the next mixin from\n    // being called\n    // key is 'onKeyPress' here, this allows reuse of these functions\n    // args is the arguments we were called with; treat it like an arraylike object\n    // thrower is a special function which attempts to improve the error stack by including\n    // the location where it was actually mixed in\n    onKeyPress: function(left, right, key) {\n        left = left || function(){};\n        right = right || function(){};\n        return function(args, thrower){\n            var event = args[0];\n\n            if (!event) thrower(TypeError(key + ' called without an event object'));\n\n            var ret = left.apply(this, args);\n            if (event && !event.immediatePropagationIsStopped) {\n                var ret2 = right.apply(this, args);    \n            }\n            return ret || ret2;\n        }\n    }\n}, {\n    // optional extra arguments and their defaults\n\n    // what should we do when the function is unknown?\n    // most likely ONCE or NEVER\n    unknownFunction: mixins.ONCE,\n\n    // what should we do when there's a non-function property?\n    // this function isn't exposed but the signature is (left, right, key) => any, with this pattern:\n    //  undefined, y => y\n    //  x, undefined => x\n    //  _, _ => THROWS\n    // note: it doesn't need to return a function\n    nonFunctionProperty: \"INTERNAL\"\n});\n\n\n// simple usage example\nvar mixin = {\n    getState(foo){\n        return {bar: foo+1}    \n    }\n};\n\nclass Duck {\n    render(){\n        console.log(this.getState(5)); // {baz: 4, bar: 6}\n    }\n\n    getState(foo){\n        return {baz: foo - 1}\n    }\n}\n\n// apply the mixin\nmixIntoGameObject(Duck.prototype, mixin);\n\n// use it\nnew Duck().render();\n```\n\n# That's it\n\nNothing too crazy, this was mostly built for use in react-class-mixins, but hopefully\nis useful to other people.  I'll be adding more test coverage (the mixin.FN apis are fully tested, but not the actual mixin function).  Any bug reports will be fixed ASAP.\n\n# License\n\nMIT\n","readmeFilename":"README.md","_id":"smart-mixin@1.2.1","_from":"smart-mixin@>=1.2.0 <2.0.0"}